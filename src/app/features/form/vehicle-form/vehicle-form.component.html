<h1 mat-dialog-title class="d-flex align-items-center">
  <i class="bi bi-truck-front-fill me-2"></i>
  Add New Vehicle
</h1>

<div mat-dialog-content [formGroup]="vehicleForm">
  <p>Please fill out the details for the new vehicle.</p>

  <!-- Basic Vehicle Info -->
  <div class="form-grid">
    <mat-form-field appearance="outline">
      <mat-label>Vehicle Number</mat-label>
      <input matInput formControlName="vehicleNumber" placeholder="e.g., MH 12 AB 1234">
      <mat-error *ngIf="vehicleForm.get('vehicleNumber')?.hasError('required')">Vehicle number is required</mat-error>
      <mat-error *ngIf="vehicleForm.get('vehicleNumber')?.hasError('pattern')">Invalid format</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Vehicle Type</mat-label>
      <mat-select formControlName="vehicleType">
        <mat-option *ngFor="let type of vehicleTypes" [value]="type">{{ type }}</mat-option>
      </mat-select>
      <mat-error *ngIf="vehicleForm.get('vehicleType')?.hasError('required')">Vehicle type is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Manufacturer</mat-label>
      <input matInput formControlName="manufacturer">
      <mat-error *ngIf="vehicleForm.get('manufacturer')?.hasError('required')">Manufacturer is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Model</mat-label>
      <input matInput formControlName="model">
      <mat-error *ngIf="vehicleForm.get('model')?.hasError('required')">Model is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Year</mat-label>
      <input matInput type="number" formControlName="year">
      <mat-error *ngIf="vehicleForm.get('year')?.hasError('required')">Year is required</mat-error>
      <mat-error *ngIf="vehicleForm.get('year')?.hasError('min') || vehicleForm.get('year')?.hasError('max')">Invalid year</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Capacity (tons)</mat-label>
      <input matInput type="number" formControlName="capacity">
      <mat-error *ngIf="vehicleForm.get('capacity')?.hasError('required')">Capacity is required</mat-error>
      <mat-error *ngIf="vehicleForm.get('capacity')?.hasError('min')">Capacity must be positive</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Status</mat-label>
      <mat-select formControlName="status">
        <mat-option *ngFor="let status of statusOptions" [value]="status">{{ status }}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Fare Details -->
  <fieldset formGroupName="fareDetails" class="fare-details">
    <legend>Fare Details</legend>

    <mat-form-field appearance="outline">
      <mat-label>Per Km Rate</mat-label>
      <input matInput type="number" formControlName="perKmRate">
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Whole Fare</mat-label>
      <input matInput type="number" formControlName="wholeFare">
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Sharing Fare</mat-label>
      <input matInput type="number" formControlName="sharingFare">
    </mat-form-field>

    <mat-checkbox formControlName="gstIncluded">GST Included</mat-checkbox>

    <mat-form-field appearance="outline">
      <mat-label>Moving Insurance</mat-label>
      <input matInput type="number" formControlName="movingInsurance">
    </mat-form-field>
  </fieldset>

  <!-- Documents -->
  <fieldset formGroupName="documents" class="documents">
    <legend>Documents</legend>

    <div formGroupName="registration">
      <mat-form-field appearance="outline">
        <mat-label>Registration Number</mat-label>
        <input matInput formControlName="number">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Expiry Date</mat-label>
        <input matInput type="date" formControlName="expiryDate">
      </mat-form-field>
    </div>

    <div formGroupName="insurance">
      <mat-form-field appearance="outline">
        <mat-label>Policy Number</mat-label>
        <input matInput formControlName="policyNumber">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Expiry Date</mat-label>
        <input matInput type="date" formControlName="expiryDate">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Provider</mat-label>
        <input matInput formControlName="provider">
      </mat-form-field>
    </div>

    <div formGroupName="permit">
      <mat-form-field appearance="outline">
        <mat-label>Permit Number</mat-label>
        <input matInput formControlName="number">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Expiry Date</mat-label>
        <input matInput type="date" formControlName="expiryDate">
      </mat-form-field>
    </div>

    <div formGroupName="fitness">
      <mat-form-field appearance="outline">
        <mat-label>Certificate Number</mat-label>
        <input matInput formControlName="certificateNumber">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Expiry Date</mat-label>
        <input matInput type="date" formControlName="expiryDate">
      </mat-form-field>
    </div>

    <div formGroupName="pollution">
      <mat-form-field appearance="outline">
        <mat-label>Certificate Number</mat-label>
        <input matInput formControlName="certificateNumber">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Expiry Date</mat-label>
        <input matInput type="date" formControlName="expiryDate">
      </mat-form-field>
    </div>
  </fieldset>

  <!-- Next Service Date & Active -->
  <div class="extra-fields">
    <mat-form-field appearance="outline">
      <mat-label>Next Service Date</mat-label>
      <input matInput type="date" formControlName="nextServiceDate">
    </mat-form-field>

    <mat-checkbox formControlName="isActive">Active</mat-checkbox>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>
</div>

<div mat-dialog-actions align="end">
  <button mat-stroked-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="isLoading">
    {{ isLoading ? 'Saving...' : 'Save Vehicle' }}
  </button>
</div>
